\section{Внутренняя геометрия поверхностей}

\subsection{Ковариантное дифференцирование, геодезические линии}

Мы хотим построить анализ на поверхности, который будет опираться только на её внутреннюю геометрию. В частности, мы хотим научиться дифференцировать векторные поля. Пусть на поверхности задано векторное поле $\vec{v}(t)$, гладко зависящее от времени. Обычное дифференцирование $\frac{d\vec{v}}{dt}$ нам не подойдёт, потому что такие векторы не обязательно касательные, так что на них нельзя смотреть с точки зрения внутренней геометрии поверхности. Для наших целей нужно как-то модифицировать обычное дифференцирование.

Для правильного подхода нам стоит ответить на вопрос: какой разумный смысл можно придать словам <<идти прямо>> на поверхности? Хороший взгляд следующий --- положим на поверхность бусинку (которая не будет с неё слетать) и приведём её в движение слабым щелчком без последующего воздействия каких-либо внешних сил. Логично сказать, что тогда бусинка будет <<двигаться прямо>> по поверхности (по направлению, в котором мы её толкнули), при этом на неё действует лишь сила нормальной реакции, всюду перпендикулярная поверхности.  Так, мы естественно пришли к точке зрения, что <<идти прямо>> вдоль какого-то направления на поверхности --- это идти так, чтобы вектор нашего ускорения был перпендикулярен этому направлению.

\begin{definition}
	\textit{Ковариантной производной} векторного поля $\vec{v}(t)$ по направлению (постоянного) векторного поля $\vec{w}$ называется векторное поле
	\[
		\big(\nabla_{\vec{w}}\vec{v}\big)(\vec{x}) \vcentcolon = \proj_{\vec{w}(\vec{x})}\frac{d\vec{v}}{dt}.
	\]
	\textit{Частными ковариантными производными} назовём ковариантные производные вдоль базисных векторных полей $\vec{r}_i$:
	\[
		\big(\nabla_i\vec{v}\big)(\vec{x}) = \proj_{\vec{r}_i(\vec{x})}\frac{d\vec{v}}{dt}.
	\]
\end{definition}

Способ, которым мы решили проблему может показаться слишком наивным. У нас была проблема --- векторы $\frac{d\vec{v}}{dt}$ не обязательно касаются поверхности, а мы изменили их очень понятным образом --- просто спроецировали на касательное пространство. Однако мы правильно мотивировали наши действия, поэтому именно такое определение может привести нас к плодотворной теории.

Отметим, что проекция --- линейная операция, а потому выполнено
\[
	\nabla_{\vec{w}}\vec{v} = W^i\nabla_i\vec{v},
\]
так что ковариантная производная вдоль векторного поля однозначно определяется частными ковариантными производными, поэтому полезно вывести общие формулы для частных ковариантных производных. Сначала найдём обычные частные производные векторного поля $\vec{r}$ по направлениям векторов $\vec{r}_i$:
\begin{equation} \label{eq:PartialVectorField}
	\partial_i\vec{v} = \frac{\partial V^k}{\partial u^i}\vec{r}_k + V^j\vec{r}_{ij} \stackrel{\eqref{eq:DerivativeGauss}}{=\joinrel=} \frac{\partial V^k}{\partial u^i}\vec{r}_k + V^j(\Gamma_{ij}^k\vec{r}_k + b_{ij}\vec{n}).
\end{equation}

Мы понимаем, что $\big(\nabla_i\vec{v}\big)(\vec{x}) = \proj_{\T_{\vec{x}}\M}\partial_i\vec{v}$. Спроектировать на касательное пространство частные производные \eqref{eq:PartialVectorField} --- значит убрать у них слагаемые с $\vec{n}$. Получаем:
\[
	\nabla_i\vec{v} = \br{\frac{\partial V^k}{\partial u^i} + \Gamma_{ij}^kV^j}\vec{r}_k.
\]
Часто эту формулу записывают так:
\begin{equation} \label{eq:CovariantVectorField}
	\big(\nabla_i\vec{v}\big)^k = \frac{\partial V^k}{\partial u^i} + \Gamma_{ij}^kV^j
\end{equation}

Выбор коэффициентов $\Gamma_{ij}^k$ так, чтобы выражение \eqref{eq:CovariantVectorField} не зависело от выбора системы координат, называется \textit{связностью} (на многообразии). Определяя $\Gamma_{ij}^k$ как символы Кристоффеля, то есть по тождествам \eqref{eq:ChristoffelIdentity}, мы получаем \textit{симметричную риманову связность}. В этом курсе мы будем сталкиваться только с ней.

Итак, общая формула ковариантной производной имеет вид
\begin{equation} \label{eq:CovariantFormula}
	\big(\nabla_{\vec{w}}\vec{v}\big)^k = \big(W^i\nabla_i\vec{v}\big)^k = W^i\frac{\partial V^k}{\partial u^i} + \Gamma_{ij}^kW^iV^j.
\end{equation}

Отметим глубинный смысл формулы, полученной нами при решении задачи \ref{problem:ChristoffelNotTensor}. Дело в том, что нетензорный характер преобразования символов Кристоффеля компенсирует <<нетензорность>> частной производной. (Ведь ковариантная производная уже обязана меняться, как тензор!) В частности, с помощью этого наблюдения можно более простым путём прийти к формуле преобразования символов Кристоффеля, выведенной нами ранее лобовыми вычислениями.

Итак, мы поняли, что <<движением прямо>> вдоль некоторого векторного поля $\vec{w}$ мы хотим называть такое движение, что наша ковариантная производная вдоль этого векторного поля всюду равна нулю.

\begin{definition}
	Векторное поле $\vec{v}$ называется \textit{ковариантно постоянным} вдоль направления векторного поля $\vec{w}$, если $\nabla_{\vec{w}}\vec{v} \equiv 0$.
\end{definition}

Получаем систему уравнений $\big(\nabla_{\vec{w}}\vec{v}\big)^k = 0$ или, если расписать по формулам \eqref{eq:CovariantFormula},
\[
	W^i\frac{\partial V^k}{\partial u^i} + \Gamma_{ij}^kW^iV^j = 0.
\]

Видим, что это система дифференциальных уравнений первого порядка на $\vec{v}$. Из теоремы о существовании и единственности мы знаем, что она имеет единственное решение при любых начальных условиях. А начальные условия здесь --- это касательный вектор в момент времени $t = 0$: $\vec{v}(0) = \vec{\xi}$. Таким образом, мы определили операцию \textit{параллельного переноса} вектора $\vec{\xi}$ вдоль векторного поля $\vec{w}$. Однако нас, как правило, будет интересовать конкретный частный случай, когда векторное поле, вдоль которого мы будем осуществлять параллельный перенос, образовано векторами скорости регулярной кривой на поверхности.

Векторы скорости произвольной регулярной кривой $\vec{\gamma}(t) = (u^1(t), u^2(t))$ на поверхности задают на этой кривой гладкое векторное поле, так что мы можем ковариантно дифференцировать вдоль кривой:
\[
	\nabla_{\dot{\vec{\gamma}}}\vec{v} = \dot{\gamma}^i\nabla_i\vec{v}.
\]
Подставим сюда формулы \eqref{eq:CovariantFormula}:
\[
	\big(\nabla_{\dot{\vec{\gamma}}}\vec{v}\big)^k = \big(\dot{\gamma}^i\nabla_i\vec{v}\big)^k = \dot{\gamma}^i\frac{\partial V^k}{\partial u^i} + \dot{\gamma}^i\Gamma_{ij}^kV^j = \frac{dV^k}{dt} + \dot{\gamma}^i\Gamma_{ij}^kV^j.
\]

\begin{definition}
	\textit{Параллельным переносом} вектора $\vec{\xi}$ вдоль кривой $\vec{\gamma}(t)$ называется векторное поле $\vec{v}(t)$, для которого $\vec{v}(0) = \vec{\xi}$ и $\nabla_{\dot{\vec{\gamma}}}\vec{v} \equiv \vec{0}$:
	\begin{equation} \label{eq:ParallelTranslation}
		\frac{dV^k}{dt} + \Gamma_{ij}^k\dot{\gamma}^iV^j = 0.
	\end{equation}
	Уравнения \eqref{eq:ParallelTranslation} при этом называются \textit{уравнениями параллельного переноса}.
\end{definition}

Иными словами, параллельный перенос --- это процесс построения векторного поля, ковариантно постоянного вдоль данной кривой, с данным начальным вектором.

\begin{lemma}
	Параллельный перенос сохраняет скалярное произведение. В частности, при параллельном переносе сохраняются длины векторов и углы между ними.
\end{lemma}

\begin{proof}
	Достаточно проверить, что при параллельном переносе сохраняются длины векторов (так как билинейная форма однозначно восстанавливается по соответствующей ей квадратичной форме). А это следует из того, что для векторного поля $\vec{v}$, ковариантно постоянного вдоль некоторого пути на поверхности, выполнено $\vec{v} \perp \dot{\vec{v}}$ сразу из определения ковариантной производной.
\end{proof}

\begin{problem}
	На какой угол повернётся касательный вектор к единичной сфере после параллельного переноса вдоль параллели $\theta = \theta_0$ ($0 \leqslant \theta_0 \leqslant \frac{\pi}{2}$) на угол $2\pi$?
\end{problem}

\begin{solution}
	Напомним, что параметризация $\vec{r}(\theta, \varphi)$ единичной сферы имеет вид
	\[
		x = \sin\theta\cos\varphi,\quad y = \sin\theta\sin\varphi,\quad z = r\cos\theta,
	\]
	где $0 \leqslant \theta \leqslant \pi$, $0 \leqslant \varphi < 2\pi$. Отсюда можем легко найти первую квадратичную форму сферы:
	\[
		\G =
		\begin{pmatrix}
			1 & 0\\
			0 & \sin^2\theta
		\end{pmatrix}.
	\]

	Глобально мы хотим написать уравнение \eqref{eq:ParallelTranslation} параллельного переноса вдоль замкнутой кривой $\theta = \theta_0$ и решить его. Для этого нам нужно сначала найти символы Кристоффеля, воспользовавшись для этого тождествами Кристоффеля. Сначала хорошо бы явно выписать обратную матрицу метрики:
	\[
		\G^{-1} = \frac{1}{\sin\theta}
		\begin{pmatrix}
			\sin^2\theta & 0\\
			0 & 1
		\end{pmatrix}.
	\]

	Отметим два полезных факта: во-первых, метрика $\G$ зависит только от значения параметра $\theta$, а во-вторых, матрицы $\G$ и $\G^{-1}$ диагональные. Это существенно сокращает вычиления. Получаем, что единственными ненулевыми символами Кристоффеля оказываются
	\[
		\Gamma_{22}^1 = -\sin\theta\cos\theta,\quad \Gamma_{12}^2 = \Gamma_{21}^2 = \ctg\theta.
	\]

	Параллель $\theta = \theta_0$ в нашей параметризации параметризуется следующим образом: $\theta(t) \hm= \theta_0$, $\varphi(t) = t$, $0 \leqslant t < 2\pi$. Тогда $\dot{\theta} = 0$, $\dot{\varphi} = 1$. Уравнения параллельного переноса \eqref{eq:ParallelTranslation}
	\[
		\frac{dV^k}{dt} + \Gamma_{ij}^k\dot{\gamma}^iV^j = 0
	\]
	в нашем случае имеют вид
	\[
		\begin{cases}
			\begin{aligned}
				&\frac{dV^1}{dt} + \Gamma_{22}^1\dot{\varphi}V^2 = 0,\\
				&\frac{dV^2}{dt} + \underbrace{\Gamma_{12}^2\dot{\theta}V^2}_{0} + \Gamma_{21}^2\dot{\varphi}V^1 = 0
			\end{aligned}
		\end{cases} \Rightarrow
		\begin{cases}
			\begin{aligned}
				&\frac{dV^1}{dt} - \sin\theta_0\cos\theta_0V^2 = 0,\\
				&\frac{dV^2}{dt} + \ctg\theta_0V^1 = 0.
			\end{aligned}
		\end{cases}
	\]

	Это однородная линейная система обыкновенных дифференциальных уравнений на компоненты $(V^1, V^2)$ поля. Можно продемонстрировать мастерство и решить её стандартными методами, изученными в рамках соответствующего курса. Но мы схитрим --- продифференцируем первое уравнение
	\[
		\frac{dV^2}{dt} = \frac{1}{\sin\theta_0\cos\theta_0}\frac{d^2V^1}{dt^2}
	\]
	и поставим во второе:
	\[
		\frac{1}{\cancel{\sin\theta_0}\cos\theta_0}\frac{d^2V^1}{dt^2} + \frac{\cos\theta_0}{\cancel{\sin\theta_0}}V^1 = 0.
	\]
	Получаем уравнение малых колебаний:
	\[
		\frac{d^2V^1}{dt^2} + \cos^2\theta_0V^1 = 0.
	\]

	На самом деле, дальше нам дорешивать ничего не нужно. Отсюда мы уже видим, что при таком параллельном переносе вектор вращается с амплитудой $\cos\theta_0$. Так что при полном обороте вокруг параллели вектор повернётся на угол $2\pi\cos\theta_0$.
\end{solution}

Из последней задачи видно, что при параллельном переносе по замкнутой траектории вектор может не перейти в себя, но повернуться на некоторый угол. Этот эффект вызван кривизной поверхности, по которой осуществляется перенос.

\begin{definition}
	Кривая $\vec{\gamma}(t)$ называется \textit{геодезической линией}, если $\nabla_{\dot{\vec{\gamma}}}\dot{\vec{\gamma}} \equiv \vec{0}$:
	\begin{equation} \label{eq:Geodesic}
		\ddot{\gamma}^k + \Gamma_{ij}^k\dot{\gamma}^i\dot\gamma^j = 0.
	\end{equation}
	Уравнения \eqref{eq:Geodesic} называют \textit{уравнениями геодезической}.
\end{definition}

Геодезические --- это те кривые, которые будет вырисовывать бусинка, двигаясь по поверхности без воздействия внешних сил. Уравнения \eqref{eq:Geodesic} --- это дифференциальные уравнения уже \underline{второго} порядка, а потому начальными условиями для него служат точка $\vec{\gamma}(0)$ и вектор скорости $\dot{\vec{\gamma}}(0)$ --- куда положить бусинку и в какую сторону её толкнуть.

\begin{problem}
	Найти геодезические на геликоиде.
\end{problem}

\begin{solution}
	Напомним, что параметризация $\vec{r}(u, v)$ геликоида имеет вид
	\[
		x = u\sin v,\quad y = u\cos v,\quad z = v,
	\]
	где $u, v \in \R$. Находим метрику:
	\[
		\G =
		\begin{pmatrix}
			1 & 0\\
			0 & u^2 + 1
		\end{pmatrix}.
	\]
	Затем находим символы Кристоффеля. Аналогично прошлой задаче получим, что единственные ненулевые символы есть
	\[
		\Gamma_{22}^1 = -u,\quad \Gamma_{12}^2 = \frac{u}{u^2 + 1}.
	\]
	Теперь хотим написать уравнения геодезических \eqref{eq:Geodesic}
	\[
		\ddot{\gamma}^k + \Gamma_{ij}^k\dot{\gamma}^i\dot{\gamma}^j = 0
	\]
	и решить их. В нашем случае уравнения имеют следующий вид:
	\[
		\begin{cases}
			\ddot{u} + \Gamma_{22}^1\dot{v}^2 = 0,\\
			\ddot{v} + 2\Gamma_{12}^2\dot{u}\dot{v} = 0
		\end{cases} \Rightarrow
		\begin{cases}
			\begin{aligned}
				&\ddot{u} - u\dot{v}^2 = 0,\\
				&\ddot{v} + \frac{2u\dot{u}}{u^2 + 1}\dot{v} = 0.
			\end{aligned}
		\end{cases}
	\]

	Заметим, что можно домножить второе уравнение на $u^2 + 1$, получив в левой части полный дифференциал. Тогда получаем следующие уравнения:
	\[
		\begin{cases}
			\begin{aligned}
				&\ddot{u} - u\dot{v}^2 = 0,\\
				&\frac{d}{dt}\big((u^2 + 1)\dot{v}\big) = 0.
			\end{aligned}
		\end{cases}
	\]

	Получаем, что $(u^2 + 1)\dot{v} = C_1$ ($C_1 \in \R$). Отсюда выражаем $\dot{v} = C_1 / (u^2 + 1)$ и подставляем в первое уравнение:
	\[
		\ddot{u} - \frac{C_1^2u}{(u^2 + 1)^2} = 0.
	\]

	Чтобы решить это уравнение, необходимо вспомнить трюк из задачника Филиппова: рассмотрим $\dot{u}$ как функцию $P(u)$ от $u$. В таких обозначениях будем иметь
	\[
		\ddot{u} = \frac{d}{dt}(\dot{u}) = \frac{d}{dt}(P(u)) = \dot{u}P^\prime = PP^\prime.
	\]
	(Здесь штрихом обозначена производная по $u$.) Подставляем:
	\begin{gather*}
		PP^\prime - \frac{C_1^2u}{(u^2 + 1)^2} = 0,\quad PdP = \frac{C_1^2u}{(u^2 + 1)^2}du,\\
		\int PdP = C_1^2\int\frac{udu}{(u^2 + 1)^2}.
	\end{gather*}
	Первообразная в левой части с точностью до константы есть $\frac{P^2}{2}$. Интеграл в правой части легко считается:
	\[
		\int\frac{udu}{(u^2 + 1)^2} = \frac{1}{2}\int\frac{d(u^2 + 1)}{(u^2 + 1)^2} = -\frac{1}{2(u^2 + 1)} + C.
	\]
	Итого получаем
	\[
		P^2 = -\frac{C_1^2}{(u^2 + 1)} + C_2.
	\]

	Явно это дифференциальное уравнение уже не решается. Но мы получили возможность в приемлемом виде выразить ответ:
	\begin{gather*}
		du = \pm\sqrt{-\frac{C_1^2}{2(u^2 + 1)} + C_2}\,dt,\\
		\frac{dv}{du} = \pm\frac{C_1}{(u^2 + 1)\sqrt{-\frac{C_1^2}{(u^2 + 1)} + C_2}} = \pm\frac{C_1}{\sqrt{C_2(u^2 + 1)^2 - C_1^2(u^2 + 1)}}.
	\end{gather*}
\end{solution}

\subsection{Геодезические как экстремали функционала действия}

Пусть $\L = \L(\vec{x}, \vec{y}, t)$ --- гладкая функция трёх аргументов $\vec{x},\,\vec{y} \in \R^n$, $t \in \R$. Эту функцию будем называть \textit{лагранжианом}. Для гладкого пути $\vec{\gamma}\colon [0; 1] \to \R^n$ определим \textit{действие} $\mathcal{S}(\vec{\gamma})$ этого пути по формуле
\begin{equation} \label{eq:Action}
	\mathcal{S}(\vec{\gamma}) \vcentcolon = \int\limits_0^1\L(\vec{\gamma}(t), \dot{\vec{\gamma}}(t), t)dt
\end{equation}
и зададим следующий вопрос: когда действие данного пути $\vec{\gamma}$ принимает наименьшее значение среди всех путей с тем же началом $\vec{\gamma}(0)$ и концом $\vec{\gamma}(1)$?

Оказывается, эволюция многих физических систем подчинена простому принципу: ограничение траектории движения на малый промежуток времени минимизирует некоторый функционал действия\footnotemark{}. Чтобы описать такую систему, достаточно указать её лагранжиан.

\footnotetext{Например, все системы классической механики лагранжевы, лагранжианом для них является разность кинетической и потенциальной энергий.}

Необходимым условием достижения минимума, как известно, равенство нулю первых производных. Сейчас мы введём аналог именно этого более слабого условия для бесконечномерного пространства всех путей.

\begin{definition}
	Пусть $\vec{\gamma}\colon [0; 1] \to \R^n$ --- некоторый путь. Под его \textit{однопараметрической деформацией} понимается любая гладкая функция $\vec{\gamma}_\tau(t)$ от двух переменных $\tau$ и $t$ такая, что $\vec{\gamma}_0(t) = \vec{\gamma}(t)$ при всех $t$ и $\vec{\gamma}_\tau(0) = \vec{\gamma}(0)$, $\vec{\gamma}_\tau(1) = \vec{\gamma}(1)$ при всех $\tau$.

	Говорят, что путь $\vec{\gamma}$ является \textit{экстремалью} для функционала действия \eqref{eq:Action}, если для любой его однопараметрической деформации $\vec{\gamma}_\tau$ выполнено
	\[
		\left.\frac{d}{d\tau}\mathcal{S}(\vec{\gamma}_\tau)\right|_{\tau = 0} = 0.
	\]
\end{definition}

Поскольку в лагранжиан $\L(\vec{x}, \vec{y}, t)$ вместо $\vec{x}$ и $\vec{y}$ всегда подставляются $\vec{\gamma}(t)$ и $\dot{\vec{\gamma}}(t)$ для некоторого пути, частные производные $\partial\L / \partial x^i$ и $\partial\L / \partial y^i$, в которых также сделаны эти подстановки, будут обозначаться через $\partial\L / \partial\gamma^i$ и $\partial\L / \partial\dot{\gamma}^i$ соответственно.

\begin{lemma}
	Гладкий путь $\vec{\gamma}$ является экстремалью для функционала действия \eqref{eq:Action} тогда и только тогда, когда он удовлетворяет следующей системе обыкновенных дифференциальных уравнений второго порядка:
	\begin{equation} \label{eq:EulerLagrange}
		\frac{d}{dt}\frac{\partial\L}{\partial\dot{\gamma}^i} = \frac{\partial\L}{\partial\gamma^i}.
	\end{equation}
\end{lemma}

\begin{proof}
	Пусть $\vec{\gamma}_\tau$ --- некоторая однопараметрическая деформация пути $\vec{\gamma}\colon [0; 1] \hm\to \R^n$. Обозначим через $\vec{v}(t)$ вектор $\partial\vec{\gamma}_\tau(t) / \partial\tau$. Поскольку при деформации концы предполагаются фиксированными, мы имеем $\vec{v}(0) = \vec{v}(1) = 0$.

	Вычислим производную $d\mathcal{S}(\vec{\gamma}_\tau) / d\tau$, занеся производную под знак интеграла:
	\begin{multline*}
		\frac{d\mathcal{S}(\vec{\gamma}_\tau)}{d\tau} = \int\limits_0^1\frac{\partial\L(\vec{\gamma}_\tau(t), \dot{\vec{\gamma}}_\tau(t), t)}{\partial\tau}dt =\\ = \int\limits_0^1\br{\frac{\partial\L}{\partial\gamma^i}v^i(t) + \frac{\partial\L}{\partial\dot{\gamma}^i}\dot{v}^i(t)}dt \stackrel{\eqref{eq:EulerLagrange}}{=\joinrel=} \int\limits_0^1\br{\br{\frac{d}{dt}\frac{\partial\L}{\partial\dot{\gamma}^i}}v^i + \frac{\partial\L}{\partial\dot{\gamma}^i}\dot{v}^i}\!(t)\,dt =\\ = \int\limits_0^1\frac{d}{dt}\br{\frac{\partial\L}{\partial\dot{\gamma}^i}v^i}dt = \left.\frac{\partial\L}{\partial\dot{\gamma}^i}v^i\right|_0^1 = 0,
	\end{multline*}
	так как $\vec{v}(0) = \vec{v}(1) = 0$, что отмечалось выше.

	Наоборот, пусть $\vec{\gamma}$ --- экстремаль. Возьмём произвольную гладкую функцию $\varphi\colon [0; 1] \to \R$ со свойствами $\varphi(0) = \varphi(1) = 0$, $\varphi(t) > 0$ для всех $0 < t < 1$, и положим
	\[
		\vec{v}(t) \vcentcolon = \varphi(t)\br{\frac{\partial\L}{\partial\gamma^i} - \frac{d}{dt}\frac{\partial\L}{\partial\dot{\gamma}^i}},\quad \vec{\gamma}_\tau(t) \vcentcolon = \gamma(t) + \tau\vec{v}(t).
	\]
	Получим
	\[
		0 = \frac{d\mathcal{S}(\vec{\gamma}_\tau)}{d\tau} = \int\limits_0^1\varphi(t)\abs{\vec{v}(t)}^2dt,
	\]
	откуда $\vec{v}(t) = 0$ при всех $0 \leqslant t \leqslant 1$, что влечёт выполнение условий \eqref{eq:EulerLagrange}.
\end{proof}

Уравнения \eqref{eq:EulerLagrange} называются \textit{уравнениями Эйлера "---Лагранжа}. Набор величин $\partial\L / \partial\dot{\gamma}^i$, $i = 1, \ldots, n$, называется \textit{импульсом} данной системы, а набор $\partial\L / \partial\gamma^i$, $i = 1, \ldots, n$, --- действующей на неё \textit{силой}. Тогда уравнения Эйлера "---Лагранжа представляют собой обобщение второго закона Ньютона: производная импульса по времени равна действующей силе.

\begin{theorem}
	Для параметризованной кривой $\vec{\gamma}\colon [0; 1] \to \M$ на поверхности $\M$ следующие условия равносильны:
	\begin{enumerate}[nolistsep, label=(\arabic*)]
		\item кривая $\vec{\gamma}$ является геодезической, а её параметризация пропорциональна натуральной;
		\item кривая $\vec{\gamma}$ является экстремалью следующего функционала действия в классе путей на поверхности $\M$:
			\[
				\mathcal{S}(\vec{\gamma}) = \int\limits_0^1\abs{\dot{\vec{\gamma}}(t)}^2dt.
			\]
	\end{enumerate}
\end{theorem}

\begin{proof}
	Лагранжиан рассматриваемого действия в локальных координатах поверхности записывается следующим образом:
	\[
		\L(\vec{\gamma}, \dot{\vec{\gamma}}) = g_{ij}(\vec{\gamma})\dot{\gamma}^i\dot{\gamma}^j.
	\]
	Вычислим $i$-е компоненты импульса $\vec{p}$ и силы $\vec{f}$:
	\[
		p_i = \frac{\partial\L}{\partial\dot{\gamma}^i} = 2g_{ij}\dot{\gamma}^j,\quad f_i = \frac{\partial\L}{\partial\gamma^i} = \frac{\partial g_{kl}}{\partial\gamma^i}\dot{\gamma}^k\dot{\gamma}^l.
	\]
	Используя \eqref{eq:AlmostCristoffelIdentity}, получаем
	\begin{gather*}
		\dot{p}_i = \frac{d}{dt}(2g_{ij}\dot{\gamma}^j) = 2\br{g_{ij}\ddot{\gamma}^j + \frac{\partial g_{ij}}{\partial\gamma^k}\dot{\gamma}^j\dot{\gamma}^k} = 2(g_{ij}\ddot{\gamma}^j + \Gamma_{ik}^sg_{sj}\dot{\gamma}^k\dot{\gamma}^j + \Gamma_{jk}^sg_{si}\dot{\gamma}^k\dot{\gamma}^j),\\
		f_i =(\Gamma_{ik}g_{sl}^s + \Gamma_{il}^sg_{sk})\dot{\gamma}^k\dot{\gamma}^l.
	\end{gather*}
	Подстановка найденных выражений в уравнения Эйлера "---Лагранжа $\dot{p}_i = f_i$ даёт:
	\[
		2g_{ij}(\ddot{\gamma}^j + \Gamma_{kl}^j\dot{\gamma}^k\dot{\gamma}^l) = 0,
	\]
	что равносильно уравнению геодезических, так как $(g_{ij})$ --- невырожденная матрица.
\end{proof}

